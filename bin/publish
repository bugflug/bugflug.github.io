#!/usr/bin/env bash

cd $(dirname $0) && cd .. ; echo ''

# make sure we build first (usually)
read -n 1 -p $'build first? \n[y] yes [n] no [*] exit\n> ' ans && echo ''
case $ans in
    y|Y)
        echo ''
        ./bin/build;;
    n|N)
        echo '';;
    *)
        exit;;
esac

# get the commit msg
read -p $'commit message for [main] and [public]\n> ' ans && echo ''

# push changes to main branch first ofc
git add .
git commit -m "${ans}"
git push

# swap to public branch
git checkout -f public
git add \
    ./assets \
    ./style \
    ./bundle \
    ./frags \
    ./pages \
    ./index.html

read -p $'commit message\n> ' ans && echo ''
git commit -m "${ans}"
git push

# swap back to dev
git checkout -f main